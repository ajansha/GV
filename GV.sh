#!/bin/bash

# Function to print colored text
print_color() {
    color=$1
    text=$2
    echo -e "${color}${text}\e[0m"
}

# Function to display ASCII art for tool name
display_ascii_art() {
    cat << "EOF"
          ⠀

⠀⠀⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣮⣿⣿⣮⣽⣿⣿⣿⣿⣿⣟⣿⣿⣿⣿⣟⡿⣷⡄⠀⠀⠀
⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣽⣿⡿⠋⠉⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⡾⣿⣿⣿⣿⠟⢻⣿⣿⣿⣿⡄⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⣿⣿⣿⣿⣿⣇⠀⢀⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⡿⠟⠾⢿⣿⠿⣿⣿⣿⣿⣇⣸⣿⣿⣿⣿⣽⣆⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⡿⣿⣿⣟⣿⡏⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠀⠀⠀⠀⠀⠀⠀⠸⣿⣿⣿⣿⣿⣿⣿⣿⡟⣿⡀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢟⣿⣿⣿⣿⣿⣿⣿⣿⡼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡝⠁⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⡇⣿⡇
⣿⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⢟⣯⣿⣿⣿⣿⡿⣿⢹⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣇⣿⡇
⣿⣽⣿⣿⣽⣿⡿⣿⣿⢯⣾⠟⣩⣾⣿⣿⣿⣽⣟⣾⡏⠈⠓⠿⣿⣿⣿⠿⠿⠿⠟⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣿⣿⣿⣿⣽⣿⡇
⢳⣿⣏⣹⣿⡿⣹⣿⣿⡿⢗⢕⣿⣿⣿⣿⣿⡿⢰⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠲⠾⣿⣿⣿⡇
⣿⠙⡞⢻⣿⣵⣻⡟⣩⣡⣿⣿⣿⣿⣿⣿⣿⣯⡾⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⡇
⣿⢸⡇⣾⣷⣿⣟⣽⢟⣵⡋⣨⣼⣿⣿⣿⣟⣸⡇⠀⠀⠀⠀⢀⠀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⡟⣷
⣿⣸⣿⣿⣿⣿⡿⢫⣾⣿⣿⣿⣿⣿⣿⡿⠓⣿⠀⠀⠀⠀⠀⠈⠉⠉⠉⠉⠉⠓⠒⠒⠒⠒⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⣤⠴⠒⢚⣿⠁⣿
⣿⣿⣿⣿⣿⣿⣵⣿⣿⣿⣿⣿⣿⣿⡿⠁⠀⡟⠀⠀⠀⠀⠀⠀⠀⠀⣀⡴⠾⠓⠲⢄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⠖⠋⠉⠁⠀⠀⠀⠀⣼⡇⠀⡿
⣿⣿⣿⡟⠁⡴⠷⣄⠙⢿⣿⣿⣿⣿⠀⠀⠀⣷⠀⠀⠀⠀⢀⣠⠞⠋⣀⣀⣀⣀⣀⡠⠟⠀⠀⠀⠀⠀⠀⠰⣄⠀⡞⠁⢀⡠⠴⠦⣀⠀⠀⢀⣿⡇⢠⡇
⣿⣿⣿⠀⠘⣇⠀⠈⠳⡄⠹⣿⣿⡇⠀⠀⠀⣿⡀⠀⠀⠴⢋⣡⣶⣿⡿⠿⠿⠿⣿⣷⡄⠀⠀⠀⠀⠀⠀⠀⢹⠀⡇⠞⢉⣀⣤⣤⣈⡳⠀⣸⠉⣿⣼⠃
⣿⣿⣿⡀⠀⠉⠙⢦⣀⠹⡄⠘⣿⡇⠀⠀⠀⢹⣧⠀⠀⢴⣾⠟⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡆⡇⠰⠟⠛⠛⠛⠻⣇⠀⡇⠀⢹⣿⠀
⣿⣿⣿⣧⠀⠀⢠⡤⠯⣭⡇⠀⢹⡇⠀⠀⠀⠈⢻⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣧⢱⠀⠀⠀⠀⠀⠀⠀⢰⠃⠀⢸⢿⠀
⣿⣿⣿⣿⣆⠀⠈⢧⠀⠰⣇⠀⠀⣿⠀⠀⠀⠀⠀⢿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⠘⡆⠀⠀⠀⠀⠀⠀⡟⠀⠀⡇⢸⡇
⣿⣿⣿⣿⣿⣷⣄⠈⠙⠢⣬⣍⣛⣻⡄⠀⠀⠀⠀⠀⢻⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⡇⢿⠀⠀⠀⠀⠀⢸⠁⠀⡾⠀⢸⠃
⣿⣿⣿⣿⣿⣿⣿⣿⣶⣤⣀⣀⣉⣀⢷⠀⠀⠀⠀⠀⠀⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡽⠛⠀⠀⠀⠀⢀⡏⠀⢸⠁⢠⠏⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠉⠛⣦⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠋⠉⠚⠁⠀⠀⠀⠀⠀⠀⡾⠁⠀⣸⣰⠏⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠈⢷⡀⠀⠀⣴⠟⠀⠀⠀⠀⠀⠀⣦⣤⣤⣤⣤⣤⣤⣤⣄⣀⣤⣄⣀⣠⡄⠀⠀⠀⠀⣸⠁⠀⠀⣸⡟⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡆⠀⠀⠀⢳⣤⠼⠋⠀⠀⠀⠀⠀⠀⠀⠀⠉⠳⢤⣀⣀⣀⣀⣀⣀⣀⣠⠼⠋⠀⠀⠀⠀⣸⠃⠀⠀⠀⣿⠀⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⠈⢿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢉⡛⠛⠛⠛⠉⣀⡄⠀⠀⠀⠀⣰⠃⠀⠀⠀⠀⡏⠀⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⠀⠈⢿⣽⣷⣦⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠒⠒⠒⠊⠁⠀⠀⠀⠀⣴⡇⠀⠀⠀⠀⠀⢹⡆⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣴⣖⣒⡆⠀⠈⢻⣿⡯⣿⣿⢷⣦⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⢿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⡿⢿⡞⠃⠀⠀⠈⢿⣷⣧⣿⣾⣿⢸⣿⣿⣷⢶⣤⣀⡀⠀⠀⠀⠀⠀⣀⣴⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣋⣹⡆⠀⠀⠀⠀⠙⣿⡿⣿⣿⢸⣿⣿⣿⣾⣿⣿⣿⣻⣿⣿⣿⣿⣿⣿⣿⢹⣿⣿⡀⠀⠀⠀⠀⢀⠀⠀⠀⠀
⣿⣿⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠳⡞⠁⠀⠀⠀⠀⠀⠘⢳⣿⣿⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢸⡏⣿⣇⠀⢀⣠⣶⣿⣿⡿⠂⠀
⡿⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣏⣭⣧⠀⠀⠀⠀⠀⠀⠈⢿⣿⣼⣿⣿⣿⡷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣣⣼⣿⣶⣿⣿⣿⣿⣛⡄⠀⠀
⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣏⡹⢧⡄⠀⠀⠀⠀⠀⠀⠀⠹⣿⡿⣿⣿⡇⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢯⡁⠀⠀
⣿⣿⣿⡿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡷⣾⠃⠀⠀⠀⠀⠀⠀⠀⠀⠈⠃⣿⣿⡇⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡋⠁⠀⠀
⣿⣿⢟⣘⣯⣶⣶⣶⣿⣷⣿⡿⣿⣿⣿⣿⣿⣛⣷⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⠟⠣⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⠟⠀⠀⠀
⣿⣷⣿⣿⣿⣿⠿⠿⠿⢛⣯⣶⣾⣿⣿⣿⣿⣟⡿⢤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠃⠛⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⣷⠀⠀⠀


             ___________    ____ 
            /  _____\   \  /   / 
           |  |  __  \   \/   /  
           |  | |_ |  \      /   
           |  |__| |   \    /    
            \______|    \__/     
                    

+-------------------------------------------------------+
|                                                       |
|        GVortex - Openredirection scanner              |        
|        Author: Ajansha Shankar                        |    
|        LinkedIn: Ajansha Shankar                      |      
|        GitHub: https://github.com/ajansha             |   
+-------------------------------------------------------+

                                    
EOF
}


# Function to perform scanning for a single domain
scan_single_domain() {
    read -p "Enter the domain name: " domain
    response_headers=$(curl -s -I "$domain")
    if echo "$response_headers" | grep -qE "Location: .*$domain"; then
        print_color "\e[1;31m" "Vulnerable: Open redirection detected"
    else
        print_color "\e[1;32m" "Not Vulnerable: No open redirection detected"
       fi    
}


# Main function
main() {
    display_ascii_art
    print_color "\e[1;33m" "Welcome to the GV scanner"
    print_color "\e[1;33m" "----------------------------------"
    print_color "\e[1;33m" " "

    while true; do
        print_color "\e[1;34m" "Select an option:"
        print_color "\e[1;34m" "1. Scan domain"
        print_color "\e[1;34m" "2. Exit"
        read -p "Option: " option

        case $option in
            1)
                scan_single_domain
                ;;
    
            2)
                print_color "\e[1;31m" "Exiting(Varata mame durr:))"
                exit 0
                ;;
            *)
                print_color "\e[1;31m" "Invalid option. Please select a valid option."
                ;;
        esac
    done
}

# Calling main function
main
